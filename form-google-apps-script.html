<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Form Google Apps Script</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    :root {
      --bg-dark: #000;
      --text-light: #fff;
      --accent: #25D366;
    }

    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: var(--bg-dark);
      color: var(--text-light);
    }

    .hero-section {
      position: relative;
      height: 50vh;
      min-height: 250px;
      overflow: hidden;
    }

    #map {
      height: 100%;
      width: 100%;
    }

    .promo-text {
      position: absolute;
      top: 10px;
      width: 100%;
      text-align: center;
      font-size: 18px;
      font-weight: bold;
      text-shadow: 0 0 6px black;
      z-index: 2;
      color: white;
    }

    .info, .sidebar {
      position: absolute;
      z-index: 2;
      font-size: 12px;
    }

    .info {
      left: 10px;
      bottom: 20px;
    }

    .sidebar {
      right: 10px;
      bottom: 20px;
      display: flex;
      flex-direction: column;
      gap: 5px;
      align-items: center;
    }

    .gallery {
      padding: 20px 15px 80px;
    }

    pre.code-box {
      background: #111;
      border: 1px solid #333;
      padding: 10px 40px 10px 10px;
      border-radius: 8px;
      overflow-y: auto;
      max-height: 250px;
      font-size: 11px;
      font-family: monospace;
      white-space: pre-wrap;
      word-break: break-word;
      color: #eee;
      position: relative;
    }

    button.copy-btn {
      position: absolute;
      top: 8px;
      right: 8px;
      padding: 5px 10px;
      font-size: 11px;
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .bottom-bar {
      position: fixed;
      bottom: 0;
      width: 100%;
      background: rgba(0, 0, 0, 0.85);
      display: flex;
      justify-content: space-around;
      padding: 10px 0;
      font-size: 12px;
      z-index: 999;
    }

    .bottom-bar a {
      color: var(--text-light);
      text-decoration: none;
      text-align: center;
    }
  </style>
</head>
<body>

  <section class="hero-section">
    <div id="map"></div>
    <div class="promo-text">Terakhir dilihat<br><strong>Nasuka Foods</strong></div>

    <div class="info">
      <div>üìç GPS Realtime</div>
      <div><strong>Nasuka foods</strong></div>
      <div>Promo cilok hangat & siap saji!</div>
      <div style="color:#ffbb00;">üéµ suara asli - nasuka foods</div>
    </div>

    <div class="sidebar">
      <div>‚ù§Ô∏è 1.M</div>
      <div>üí¨ 900.K</div>
      <div>üîó Share</div>
    </div>
  </section>






  <section class="gallery">
    <p><strong>Standar nasukafood server : Kode.gs Google Apps Web</strong></p>
    <div style="position:relative">
      <pre id="kodegs" class="code-box">
function doPost(e) {
  try {
    const sheet = SpreadsheetApp.openById("18PJistQ_gxo6tLTNyxB8UCfzm-XsoSk8Tj-VDTS5WXE").getSheetByName("Tesform");

    const nama = e.parameter.nama;
    const alamat = e.parameter.alamat;
    const handphone = e.parameter.handphone;
    const tesform = e.parameter.tesform;
    const imgData = e.parameter.foto;

    const bulan = ["Januari", "Februari", "Maret", "April", "Mei", "Juni",
                   "Juli", "Agustus", "September", "Oktober", "November", "Desember"];
    const now = new Date();
    const waktuID = Utilities.formatDate(now, "GMT+7", "dd") + " " +
                    bulan[now.getMonth()] + " " +
                    now.getFullYear() + " " +
                    Utilities.formatDate(now, "GMT+7", "HH:mm");

    let fileUrl = "";
    if (imgData) {
      const blob = Utilities.newBlob(Utilities.base64Decode(imgData), MimeType.JPEG, "foto_tesform.jpg");
      const folder = DriveApp.getFolderById("11zflQ1JmTxQO-Eux8UpNaGEFIQ0utTXx");
      const file = folder.createFile(blob);
      fileUrl = file.getUrl();
    }

    sheet.appendRow([nama, alamat, handphone, tesform, fileUrl, waktuID]);

    return ContentService.createTextOutput("Sukses").setMimeType(ContentService.MimeType.TEXT);
  } catch (error) {
    return ContentService.createTextOutput("Error: " + error.message).setMimeType(ContentService.MimeType.TEXT);
  }
}

function doGet() {
  const sheet = SpreadsheetApp.openById("18PJistQ_gxo6tLTNyxB8UCfzm-XsoSk8Tj-VDTS5WXE").getSheetByName("Tesform");
  const data = sheet.getDataRange().getValues();

  const headers = data[0];
  const rows = data.slice(1);

  const json = rows.map(row => {
    let obj = {};
    headers.forEach((key, index) => {
      obj[key] = row[index];
    });
    return obj;
  });

  return ContentService
    .createTextOutput(JSON.stringify(json))
    .setMimeType(ContentService.MimeType.JSON);
}
      </pre>
      <button class="copy-btn" onclick="copyDOS('kodegs')">Salin</button>
    </div>
    
  </sectio
  
  
  
  
  
  <section class="gallery">
    <p><strong>Standar nasukafood server : Html kirimform</strong></p>
    <div style="position:relative">
      <pre id="kirim" class="code-box">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;base target=&quot;_top&quot;&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Form Tes&lt;/title&gt;
    &lt;style&gt;
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
        max-width: 500px;
        margin: auto;
      }
      input, textarea {
        width: 100%;
        padding: 8px;
        margin-bottom: 12px;
        border: 1px solid #ccc;
        border-radius: 4px;
      }
      button {
        padding: 10px 20px;
        background-color: #28a745;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }
      button:disabled {
        background-color: #aaa;
      }
    &lt;/style&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h2&gt;Form Tes&lt;/h2&gt;
    &lt;form id=&quot;formtes&quot;&gt;
      &lt;label&gt;Nama:&lt;/label&gt;
      &lt;input type=&quot;text&quot; name=&quot;nama&quot; required&gt;

      &lt;label&gt;Alamat:&lt;/label&gt;
      &lt;textarea name=&quot;alamat&quot; required&gt;&lt;/textarea&gt;

      &lt;label&gt;Handphone:&lt;/label&gt;
      &lt;input type=&quot;text&quot; name=&quot;handphone&quot; required&gt;

      &lt;label&gt;Tesform:&lt;/label&gt;
      &lt;textarea name=&quot;tesform&quot; required&gt;&lt;/textarea&gt;

      &lt;label&gt;Foto:&lt;/label&gt;
      &lt;input type=&quot;file&quot; name=&quot;foto&quot; accept=&quot;image/*&quot; required&gt;

      &lt;button type=&quot;submit&quot;&gt;Kirim&lt;/button&gt;
    &lt;/form&gt;

    &lt;p id=&quot;status&quot;&gt;&lt;/p&gt;

    &lt;script&gt;
      const form = document.getElementById('formtes');
      const status = document.getElementById('status');
      const scriptURL = 'https://script.google.com/macros/s/AKfycbxjJyyIyfRhoZ9EFB579eWmfDes1gMYfNMp3JpAJvOgRu8nC7X2LAmgjNo4StDg4WZrgA/exec';

      form.addEventListener('submit', async (e) =&gt; {
        e.preventDefault();
        status.textContent = &quot;Mengirim...&quot;;

        const formData = new FormData(form);
        const file = formData.get('foto');
        const reader = new FileReader();

        reader.onload = function() {
          const base64 = reader.result.split(',')[1];

          const data = new URLSearchParams();
          data.append('nama', formData.get('nama'));
          data.append('alamat', formData.get('alamat'));
          data.append('handphone', formData.get('handphone'));
          data.append('tesform', formData.get('tesform'));
          data.append('foto', base64);

          fetch(scriptURL, {
            method: 'POST',
            body: data
          })
          .then(response =&gt; response.text())
          .then(result =&gt; {
            status.textContent = result;
            form.reset();
          })
          .catch(error =&gt; {
            status.textContent = 'Gagal: ' + error;
          });
        };

        reader.readAsDataURL(file);
      });
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
      </pre>
      <button class="copy-btn" onclick="copyDOS('kirim')">Salin</button>
    </div>
    
 </<sectio
 
  <section class="gallery">
    <p><strong>Standar nasukafood server : Html lihatform</strong></p>
    <div style="position:relative">
      <pre id="lihat" class="code-box">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;meta charset=&quot;UTF-8&quot;&gt;
  &lt;title&gt;Lihat Data Tesform&lt;/title&gt;
  &lt;style&gt;
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 900px;
      margin: auto;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      padding: 8px;
      border: 1px solid #ccc;
      text-align: left;
    }
    th {
      background-color: #f0f0f0;
    }
    img {
      max-width: 100px;
      height: auto;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;h2&gt;Data Form Tes&lt;/h2&gt;
  &lt;table id=&quot;data-table&quot;&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Nama&lt;/th&gt;
        &lt;th&gt;Alamat&lt;/th&gt;
        &lt;th&gt;Handphone&lt;/th&gt;
        &lt;th&gt;Tesform&lt;/th&gt;
        &lt;th&gt;Foto&lt;/th&gt;
        &lt;th&gt;Waktu&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;&lt;/tbody&gt;
  &lt;/table&gt;

  &lt;script&gt;
    const url = 'https://script.google.com/macros/s/AKfycbxjJyyIyfRhoZ9EFB579eWmfDes1gMYfNMp3JpAJvOgRu8nC7X2LAmgjNo4StDg4WZrgA/exec';

    fetch(url)
      .then(res =&gt; res.json())
      .then(data =&gt; {
        const tbody = document.querySelector('#data-table tbody');
        data.forEach(item =&gt; {
          const row = document.createElement('tr');
          row.innerHTML = `
            &lt;td&gt;${item.nama}&lt;/td&gt;
            &lt;td&gt;${item.alamat}&lt;/td&gt;
            &lt;td&gt;${item.handphone}&lt;/td&gt;
            &lt;td&gt;${item.tesform}&lt;/td&gt;
            &lt;td&gt;&lt;img src=&quot;${item.foto}&quot; alt=&quot;foto&quot;/&gt;&lt;/td&gt;
            &lt;td&gt;${item.waktu}&lt;/td&gt;
          `;
          tbody.appendChild(row);
        });
      })
      .catch(error =&gt; {
        document.body.innerHTML += '&lt;p style=&quot;color:red;&quot;&gt;Gagal memuat data: ' + error + '&lt;/p&gt;';
      });
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
      </pre>
      <button class="copy-btn" onclick="copyDOS('lihat')">Salin</button>
    </div>
    
 </section>
  </section>
  </section>
  

  <div class="bottom-bar">
    <a href="#">üè†<br>Home</a>
    <a href="#">üîç<br>Layanan</a>
    <a href="#">‚ûï<br>Pesanan</a>
    <a href="#">üì®<br>Otomotif</a>
    <a href="#">üë§<br>Profil</a>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyC1pLpsAE5QJv26cEudkY6FoqzEoD9KM",
      authDomain: "posisi-saya.firebaseapp.com",
      projectId: "posisi-saya",
      storageBucket: "posisi-saya.appspot.com",
      messagingSenderId: "1090605644806",
      appId: "1:1090605644806:web:7a257eee40570904135787"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    let map = L.map('map').setView([-6.2, 106.8], 13);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '¬© OpenStreetMap contributors'
    }).addTo(map);

    let marker = L.marker([-6.2, 106.8]).addTo(map);

    const lokasiRef = doc(db, "lokasi_saya", "nasukafoods");
    onSnapshot(lokasiRef, (docSnap) => {
      if (docSnap.exists()) {
        const data = docSnap.data();
        const latlng = [data.lat, data.lng];
        marker.setLatLng(latlng);
        map.setView(latlng, 15);
      }
    });
  </script>
<script>
  function copyDOS(id) {
    const text = document.getElementById(id).innerText;
    navigator.clipboard.writeText(text).then(() => {
      alert('Kode berhasil disalin!');
    });
  }
</script>
</body>
</html>
